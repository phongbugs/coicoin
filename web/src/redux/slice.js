import { createSlice } from '@reduxjs/toolkit';
export const slice = createSlice({
  name: 'coin',
  initialState: {
    btnAddIsLoading: false,
    btnIsUpdating: false,
    isShowPrice: false,
    isShowPercent: true,
    isDCAMode: true,
    prevMarkets: {},
    errorMessage: '',
    entities: [
      // {
      //   i: 10903,
      //   n: 'Coin98',
      //   s: 'C98',
      //   r: 221,
      //   p: 'USDT',
      //   q: 509.1,
      //   of: 3324,
      //   cf: 2254.2948,
      //   price: '4.42800000',
      //   index: 1630946672529,
      // },
      // {
      //   i: 1765,
      //   n: 'EOS',
      //   s: 'EOS',
      //   r: 30,
      //   p: 'USDT',
      //   q: 372.2,
      //   of: 2227,
      //   cf: 2306.1512,
      //   price: '6.19600000',
      //   index: 1630945497869,
      // },
      // {
      //   i: 1765,
      //   n: 'EOS',
      //   s: 'EOS',
      //   r: 30,
      //   p: 'USDT',
      //   q: 36.4,
      //   of: 227,
      //   cf: 225.53439999999998,
      //   price: '6.19600000',
      //   index: 1630945378619,
      // },
      // {
      //   i: 1765,
      //   n: 'EOS',
      //   s: 'EOS',
      //   r: 30,
      //   p: 'USDT',
      //   q: 335.8,
      //   of: 2000,
      //   cf: 2080.6168,
      //   price: '6.19600000',
      //   index: 1630945430509,
      // },
      // {
      //   i: 8757,
      //   n: 'SafeMoon',
      //   s: 'SAFEMOON',
      //   r: 212,
      //   p: 'USDT',
      //   q: 36526124.1412,
      //   of: 103.49,
      //   cf: 88.38269383838187,
      //   price: 0.0000024197118067254703,
      //   index: 1630895611543,
      // },
      // {
      //   i: 8757,
      //   n: 'SafeMoon',
      //   s: 'SAFEMOON',
      //   r: 212,
      //   p: 'USDT',
      //   q: 105281687.34084447,
      //   of: 294.49,
      //   cf: 254.75134189062084,
      //   price: 0.0000024197118067254703,
      //   index: 1630946552956,
      // },
      // {
      //   i: 52,
      //   n: 'XRP',
      //   s: 'XRP',
      //   r: 6,
      //   p: 'USDT',
      //   q: 195.354,
      //   of: 250,
      //   cf: 269.197812,
      //   price: '1.37800000',
      //   index: 1630946602071,
      // },
      {
        i: 9742,
        n: 'ElonTech',
        s: 'ETCH',
        r: 3452,
        p: 'USDT',
        q: 2478298.991,
        of: 50,
        cf: 27.448604250697077,
        price: 0.000011075582224088909,
        index: 1633362579741,
      },
      {
        i: 12344,
        n: 'SafeAffinity',
        s: 'AFFINITY',
        r: 3867,
        p: 'USDT',
        q: 38625881,
        of: 50,
        cf: 47.95301815213715,
        price: 0.000001241473771229636,
        index: 1633450042010,
      },
      {
        i: 12564,
        n: 'TetherBlack',
        s: 'TTB',
        r: 3166,
        p: 'USDT',
        q: 2708.0706,
        of: 20,
        cf: 5.172796085752152,
        price: 0.001910140779103821,
        index: 1633849100711,
      },
      {
        i: 12574,
        n: 'World of Cryptia',
        s: 'CRYPT',
        r: 2982,
        p: 'USDT',
        q: 700.2675,
        of: 100,
        cf: 78.57578923336648,
        price: 0.11220824789579192,
        index: 1633920548430,
      },
      {
        i: 11414,
        n: 'Qubit',
        s: 'QBT',
        r: 3355,
        p: 'USDT',
        q: 1341.1348,
        of: 100,
        cf: 134.45799460610013,
        price: 0.10025688290699797,
        index: 1633920590197,
      },
      {
        i: 8757,
        n: 'SafeMoon',
        s: 'SAFEMOON',
        r: 212,
        p: 'USDT',
        q: 132079864.4697,
        of: 373,
        cf: 316.2242679385691,
        price: 0.0000023941898275578033,
        index: 1634187762599,
      },
      {
        i: 12021,
        n: 'Minisoccer',
        s: 'MINISOCCER',
        r: 4656,
        p: 'USDT',
        q: 1844013108997.18,
        of: 50,
        cf: 12.822798688954215,
        price: 6.953745950281e-12,
        index: 1634187860808,
      },
      {
        i: 9938,
        n: 'OpenOcean',
        s: 'OOE',
        r: 539,
        p: 'USDT',
        q: 287.6902,
        of: 213,
        cf: 204.11020306826723,
        price: 0.7094791656728913,
        index: 1634188012142,
      },
      {
        i: 12252,
        n: 'Bombcrypto',
        s: 'BCOIN',
        r: 3195,
        p: 'USDT',
        q: 256.6408,
        of: 800,
        cf: 321.4416441940687,
        price: 1.2524962679124625,
        index: 1634295282281,
      },
      {
        i: 12739,
        n: 'Revolotto',
        s: 'RVL',
        r: 3963,
        p: 'USDT',
        q: 809.4218,
        of: 100,
        cf: 288.55406676803267,
        price: 0.35649406374776743,
        index: 1634301467174,
      },
      {
        i: 1839,
        n: 'Binance Coin',
        s: 'BNB',
        r: 4,
        p: 'USDT',
        q: 0.0226,
        of: 10,
        cf: 10.83896,
        price: '479.60000000',
        index: 1634568183342,
      },
      {
        i: 12116,
        n: 'Diamond Boyz Coin',
        s: 'DBZ',
        r: 3275,
        p: 'USDT',
        q: 4182.6417,
        of: 280,
        cf: 222.52671203013344,
        price: 0.0532024323360362,
        index: 1634612814539,
      },
      {
        i: 1839,
        n: 'Binance Coin',
        s: 'BNB',
        r: 4,
        p: 'USDT',
        q: 0.0201,
        of: 9,
        cf: 9.63996,
        price: '479.60000000',
        index: 1634612863276,
      },
      {
        i: 12585,
        n: 'Demole',
        s: 'DMLG',
        r: 2888,
        p: 'USDT',
        q: 216.4735,
        of: 50,
        cf: 46.73155493305908,
        price: 0.2158765619489641,
        index: 1634782743653,
      },
      {
        i: 12281,
        n: 'Lofi Defi',
        s: 'LOFI',
        r: 3926,
        p: 'USDT',
        q: 7304042.7738,
        of: 180,
        cf: 150.9499950992638,
        price: 0.000020666636241607137,
        index: 1634886053207,
      },
      {
        i: 13073,
        n: 'Fantasy Fox',
        s: 'FF',
        slug: 'fantasy-fox',
        p: 'USDT',
        q: 1688813.1468,
        of: 50,
        cf: 35.80207583256537,
        price: 0.00002119954827471821,
        index: 1635056844021,
      },
      {
        i: 1839,
        n: 'Binance Coin',
        s: 'BNB',
        r: 4,
        p: 'USDT',
        q: 3.172887,
        of: 1530,
        cf: 1521.7166052,
        price: '479.60000000',
        index: 1635057750209,
      },
      {
        i: 825,
        n: 'Tether',
        s: 'USDT',
        r: 5,
        p: 'USDT',
        q: 0.1,
        of: 1908,
        cf: 0.09999867473871474,
        price: 0.9999867473871473,
        index: 1635058393456,
      },
      {
        i: 12362,
        n: 'AetherV2',
        s: 'ATH',
        r: 3987,
        p: 'USDT',
        q: 35623.8748,
        of: 100,
        cf: 70.33604122509014,
        price: 0.00197440737763569,
        index: 1635118805379,
      },
      {
        i: 1839,
        n: 'Binance Coin',
        s: 'BNB',
        r: 4,
        p: 'USDT',
        q: 0.7303,
        of: 350,
        cf: 350.25187999999997,
        price: '479.60000000',
        index: 1635119010904,
      },
      {
        i: 12556,
        n: 'Oculus Vision',
        s: 'OCV',
        r: 4161,
        p: 'USDT',
        q: 2333.4715,
        of: 80,
        cf: 67.48011395338828,
        price: 0.02891833645852897,
        index: 1635126075574,
      },
      {
        i: 12268,
        n: 'Inferno Pay',
        s: 'IFO',
        r: 3762,
        p: 'USDT',
        q: 26051.14,
        of: 80,
        cf: 68.25026420579199,
        price: 0.0026198571043644153,
        index: 1635126240905,
      },
      {
        i: 9938,
        n: 'OpenOcean',
        s: 'OOE',
        r: 539,
        p: 'USDT',
        q: 287.6902,
        of: 173,
        cf: 204.11020306826723,
        price: 0.7094791656728913,
        index: 1635128280264,
      },
    ],
    // originalFund:0,
    // quantityCoin:0,
    // symbolCoin:'',
    // pair:''
  },
  reducers: {
    addCoin: (state, action) => {
      // Redux Toolkit allows us to write "mutating" logic in reducers. It
      // doesn't actually mutate the state because it uses the immer library,
      // which detects changes to a "draft state" and produces a brand new
      // immutable state based off those changes
      if (action.payload) {
        let coin = { ...action.payload };
        state.entities.push(coin);
        state.btnAddIsLoading = false;
      }
    },

    getCoins: (state, _) => state.entities,

    updateCoins: (state, { payload }) => ({
      ...state,
      entities: payload,
    }),
    enableDCAMode: (state) => ({
      ...state,
      isDCAMode: true,
    }),
    disableDCAMode: (state) => ({
      ...state,
      isDCAMode: false,
    }),
    showPrice: (state) => ({
      ...state,
      isShowPrice: true,
    }),
    hidePrice: (state) => ({
      ...state,
      isShowPrice: false,
    }),
    showPercent: (state) => ({
      ...state,
      isShowPercent: true,
    }),
    hidePercent: (state) => ({
      ...state,
      isShowPercent: false,
    }),
    removeCoin: (state, action) => {
      let { index } = action.payload;
      let coinIndex = state.entities.findIndex(
        (entity) => entity.index === index
      );
      state.entities.splice(coinIndex, 1);
    },
    backupMarkets: (state) => ({
      ...state,
      prevMarkets: state.entities.reduce((markets, entity) => {
        let pair = entity.s + entity.p;
        markets[pair] = entity.price;
        return markets;
      }, {}),
    }),
  },
});

export const {
  addCoin,
  removeCoin,
  updateCoins,
  getCoins,
  enableDCAMode,
  disableDCAMode,
  hidePrice,
  showPrice,
  hidePercent,
  showPercent,
  backupMarkets,
} = slice.actions;

// The function below is called a thunk and allows us to perform async logic. It
// can be dispatched like a regular action: `dispatch(incrementAsync(10))`. This
// will call the thunk with the `dispatch` function as the first argument. Async
// code can then be executed and other actions can be dispatched

// export const addCoinAsync = (symbol) => (dispatch) => {
//   setTimeout(() => {
//     let coin = { symbol };
//     dispatch(addCoin(coin));
//   }, 1000);
// };

// The function below is called a selector and allows us to select a value from
// the state. Selectors can also be defined inline where they're used instead of
// in the slice file. For example: `useSelector((state) => state.counter.value)`
export const entities = (state) => state.coin.entities;

export default slice.reducer;
